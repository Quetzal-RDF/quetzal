SELECT ?date ?avgval ?opcnt {
 {
	SELECT ?date (AVG(?value) AS ?avgval) WHERE {
		SERVICE <http://9.12.235.45:9091/openrdf-sesame/repositories/bjdiag2> {
	  		?x <http://www.ibm.com/health/bjdiag/PM25TBL#DATE> ?date;
	    	  <http://www.ibm.com/health/bjdiag/PM25TBL#VALUE> ?value ;
			  <http://www.ibm.com/health/bjdiag/PM25TBL#MONTH> 1;
			  <http://www.ibm.com/health/bjdiag/PM25TBL#YEAR> 2015;
			  <http://www.ibm.com/health/bjdiag/PM25TBL#DAY> 22
	    } 
	} GROUP BY ?date 
}
OPTIONAL {
	SELECT ?date (COUNT(DISTINCT ?value) AS ?opcnt) WHERE {
			SERVICE <http://9.12.235.45:9091/openrdf-sesame/repositories/bjdiag2> {
		        ?x <http://www.ibm.com/health/bjdiag/DIAG_OUTPATIENT#EMPI> ?empi ;
				    <http://www.ibm.com/health/bjdiag/DIAG_OUTPATIENT#DATE> ?date ;
				    <http://www.ibm.com/health/bjdiag/DIAG_OUTPATIENT#DATE> "2015-01-22"
				FILTER (?empi = "3A743FE03E0679E45889D93A9A05BEAA")
		    } 
		} GROUP BY ?date
	}
}